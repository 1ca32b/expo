{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":100,"column":0,"index":2801}}],"key":"7kvm5yrOpz4NYiDi6sn4qxa8DVQ="}},{"name":"react","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":5,"column":0,"index":89},"end":{"line":5,"column":31,"index":120}}],"key":"a4EMkKqamYWCMMPV7UeQlqGQ+ks="}},{"name":"./NavigationBuilderContext","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":7,"column":0,"index":122},"end":{"line":9,"column":36,"index":222}}],"key":"y9eQQdj9MvCs7akL60igi3d/dsI="}},{"name":"./NavigationRouteContext","data":{"asyncType":null,"exportNames":["*"],"locs":[{"start":{"line":10,"column":0,"index":223},"end":{"line":10,"column":62,"index":285}}],"key":"HeyVDSY+CsJeYUdsxrU2U3K5dPs="}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = useOnPreventRemove;\n  exports.shouldPreventRemove = void 0;\n  var React = _interopRequireWildcard(_$$_REQUIRE(_dependencyMap[1], \"react\"));\n  var _NavigationBuilderContext = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"./NavigationBuilderContext\"));\n  var _NavigationRouteContext = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"./NavigationRouteContext\"));\n  function _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\n  function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\n  var VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n  var shouldPreventRemove = (emitter, beforeRemoveListeners, currentRoutes, nextRoutes, action) => {\n    var nextRouteKeys = nextRoutes.map(route => route.key);\n\n    // Call these in reverse order so last screens handle the event first\n    var removedRoutes = currentRoutes.filter(route => !nextRouteKeys.includes(route.key)).reverse();\n    var visitedRouteKeys =\n    // @ts-expect-error: add this property to mark that we've already emitted this action\n    action[VISITED_ROUTE_KEYS] ?? new Set();\n    var beforeRemoveAction = {\n      ...action,\n      [VISITED_ROUTE_KEYS]: visitedRouteKeys\n    };\n    for (var route of removedRoutes) {\n      if (visitedRouteKeys.has(route.key)) {\n        // Skip if we've already emitted this action for this screen\n        continue;\n      }\n\n      // First, we need to check if any child screens want to prevent it\n      var isPrevented = beforeRemoveListeners[route.key]?.(beforeRemoveAction);\n      if (isPrevented) {\n        return true;\n      }\n      visitedRouteKeys.add(route.key);\n      var event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n    return false;\n  };\n  exports.shouldPreventRemove = shouldPreventRemove;\n  function useOnPreventRemove(_ref) {\n    var getState = _ref.getState,\n      emitter = _ref.emitter,\n      beforeRemoveListeners = _ref.beforeRemoveListeners;\n    var _React$useContext = React.useContext(_NavigationBuilderContext.default),\n      addKeyedListener = _React$useContext.addKeyedListener;\n    var route = React.useContext(_NavigationRouteContext.default);\n    var routeKey = route?.key;\n    React.useEffect(() => {\n      if (routeKey) {\n        return addKeyedListener?.('beforeRemove', routeKey, action => {\n          var state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, [], action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":70,"map":[[8,2,5,0],[8,6,5,0,"React"],[8,11,5,0],[8,14,5,0,"_interopRequireWildcard"],[8,37,5,0],[8,38,5,0,"_$$_REQUIRE"],[8,49,5,0],[8,50,5,0,"_dependencyMap"],[8,64,5,0],[9,2,7,0],[9,6,7,0,"_NavigationBuilderContext"],[9,31,7,0],[9,34,7,0,"_interopRequireDefault"],[9,56,7,0],[9,57,7,0,"_$$_REQUIRE"],[9,68,7,0],[9,69,7,0,"_dependencyMap"],[9,83,7,0],[10,2,10,0],[10,6,10,0,"_NavigationRouteContext"],[10,29,10,0],[10,32,10,0,"_interopRequireDefault"],[10,54,10,0],[10,55,10,0,"_$$_REQUIRE"],[10,66,10,0],[10,67,10,0,"_dependencyMap"],[10,81,10,0],[11,2,10,62],[11,11,10,62,"_getRequireWildcardCache"],[11,36,10,62,"e"],[11,37,10,62],[11,66,10,62,"WeakMap"],[11,73,10,62],[11,92,10,62,"r"],[11,93,10,62],[11,100,10,62,"WeakMap"],[11,107,10,62],[11,111,10,62,"t"],[11,112,10,62],[11,119,10,62,"WeakMap"],[11,126,10,62],[11,138,10,62,"_getRequireWildcardCache"],[11,162,10,62],[11,174,10,62,"_getRequireWildcardCache"],[11,175,10,62,"e"],[11,176,10,62],[11,187,10,62,"e"],[11,188,10,62],[11,191,10,62,"t"],[11,192,10,62],[11,195,10,62,"r"],[11,196,10,62],[11,201,10,62,"e"],[11,202,10,62],[12,2,10,62],[12,11,10,62,"_interopRequireWildcard"],[12,35,10,62,"e"],[12,36,10,62],[12,38,10,62,"r"],[12,39,10,62],[12,48,10,62,"r"],[12,49,10,62],[12,53,10,62,"e"],[12,54,10,62],[12,58,10,62,"e"],[12,59,10,62],[12,60,10,62,"__esModule"],[12,70,10,62],[12,79,10,62,"e"],[12,80,10,62],[12,95,10,62,"e"],[12,96,10,62],[12,119,10,62,"e"],[12,120,10,62],[12,145,10,62,"e"],[12,146,10,62],[12,157,10,62,"default"],[12,164,10,62],[12,166,10,62,"e"],[12,167,10,62],[12,175,10,62,"t"],[12,176,10,62],[12,179,10,62,"_getRequireWildcardCache"],[12,203,10,62],[12,204,10,62,"r"],[12,205,10,62],[12,212,10,62,"t"],[12,213,10,62],[12,217,10,62,"t"],[12,218,10,62],[12,219,10,62,"has"],[12,222,10,62],[12,223,10,62,"e"],[12,224,10,62],[12,234,10,62,"t"],[12,235,10,62],[12,236,10,62,"get"],[12,239,10,62],[12,240,10,62,"e"],[12,241,10,62],[12,248,10,62,"n"],[12,249,10,62],[12,254,10,62,"__proto__"],[12,263,10,62],[12,273,10,62,"a"],[12,274,10,62],[12,277,10,62,"Object"],[12,283,10,62],[12,284,10,62,"defineProperty"],[12,298,10,62],[12,302,10,62,"Object"],[12,308,10,62],[12,309,10,62,"getOwnPropertyDescriptor"],[12,333,10,62],[12,344,10,62,"u"],[12,345,10,62],[12,349,10,62,"e"],[12,350,10,62],[12,370,10,62,"u"],[12,371,10,62],[12,375,10,62,"Object"],[12,381,10,62],[12,382,10,62,"prototype"],[12,391,10,62],[12,392,10,62,"hasOwnProperty"],[12,406,10,62],[12,407,10,62,"call"],[12,411,10,62],[12,412,10,62,"e"],[12,413,10,62],[12,415,10,62,"u"],[12,416,10,62],[12,425,10,62,"i"],[12,426,10,62],[12,429,10,62,"a"],[12,430,10,62],[12,433,10,62,"Object"],[12,439,10,62],[12,440,10,62,"getOwnPropertyDescriptor"],[12,464,10,62],[12,465,10,62,"e"],[12,466,10,62],[12,468,10,62,"u"],[12,469,10,62],[12,479,10,62,"i"],[12,480,10,62],[12,485,10,62,"i"],[12,486,10,62],[12,487,10,62,"get"],[12,490,10,62],[12,494,10,62,"i"],[12,495,10,62],[12,496,10,62,"set"],[12,499,10,62],[12,503,10,62,"Object"],[12,509,10,62],[12,510,10,62,"defineProperty"],[12,524,10,62],[12,525,10,62,"n"],[12,526,10,62],[12,528,10,62,"u"],[12,529,10,62],[12,531,10,62,"i"],[12,532,10,62],[12,536,10,62,"n"],[12,537,10,62],[12,538,10,62,"u"],[12,539,10,62],[12,543,10,62,"e"],[12,544,10,62],[12,545,10,62,"u"],[12,546,10,62],[12,558,10,62,"n"],[12,559,10,62],[12,560,10,62,"default"],[12,567,10,62],[12,570,10,62,"e"],[12,571,10,62],[12,573,10,62,"t"],[12,574,10,62],[12,578,10,62,"t"],[12,579,10,62],[12,580,10,62,"set"],[12,583,10,62],[12,584,10,62,"e"],[12,585,10,62],[12,587,10,62,"n"],[12,588,10,62],[12,591,10,62,"n"],[12,592,10,62],[13,2,20,0],[13,6,20,6,"VISITED_ROUTE_KEYS"],[13,24,20,24],[13,27,20,27,"Symbol"],[13,33,20,33],[13,34,20,34],[13,54,20,54],[13,55,20,55],[14,2,22,7],[14,6,22,13,"shouldPreventRemove"],[14,25,22,32],[14,28,22,35,"shouldPreventRemove"],[14,29,23,2,"emitter"],[14,36,23,52],[14,38,24,2,"beforeRemoveListeners"],[14,59,24,78],[14,61,25,2,"currentRoutes"],[14,74,25,34],[14,76,26,2,"nextRoutes"],[14,86,26,44],[14,88,27,2,"action"],[14,94,27,26],[14,99,28,5],[15,4,29,2],[15,8,29,8,"nextRouteKeys"],[15,21,29,21],[15,24,29,24,"nextRoutes"],[15,34,29,34],[15,35,29,35,"map"],[15,38,29,38],[15,39,29,40,"route"],[15,44,29,45],[15,48,29,50,"route"],[15,53,29,55],[15,54,29,56,"key"],[15,57,29,59],[15,58,29,60],[17,4,31,2],[18,4,32,2],[18,8,32,8,"removedRoutes"],[18,21,32,21],[18,24,32,24,"currentRoutes"],[18,37,32,37],[18,38,33,5,"filter"],[18,44,33,11],[18,45,33,13,"route"],[18,50,33,18],[18,54,33,23],[18,55,33,24,"nextRouteKeys"],[18,68,33,37],[18,69,33,38,"includes"],[18,77,33,46],[18,78,33,47,"route"],[18,83,33,52],[18,84,33,53,"key"],[18,87,33,56],[18,88,33,57],[18,89,33,58],[18,90,34,5,"reverse"],[18,97,34,12],[18,98,34,13],[18,99,34,14],[19,4,36,2],[19,8,36,8,"visitedRouteKeys"],[19,24,36,37],[20,4,37,4],[21,4,38,4,"action"],[21,10,38,10],[21,11,38,11,"VISITED_ROUTE_KEYS"],[21,29,38,29],[21,30,38,30],[21,34,38,34],[21,38,38,38,"Set"],[21,41,38,41],[21,42,38,50],[21,43,38,51],[22,4,40,2],[22,8,40,8,"beforeRemoveAction"],[22,26,40,26],[22,29,40,29],[23,6,41,4],[23,9,41,7,"action"],[23,15,41,13],[24,6,42,4],[24,7,42,5,"VISITED_ROUTE_KEYS"],[24,25,42,23],[24,28,42,26,"visitedRouteKeys"],[25,4,43,2],[25,5,43,3],[26,4,45,2],[26,9,45,7],[26,13,45,13,"route"],[26,18,45,18],[26,22,45,22,"removedRoutes"],[26,35,45,35],[26,37,45,37],[27,6,46,4],[27,10,46,8,"visitedRouteKeys"],[27,26,46,24],[27,27,46,25,"has"],[27,30,46,28],[27,31,46,29,"route"],[27,36,46,34],[27,37,46,35,"key"],[27,40,46,38],[27,41,46,39],[27,43,46,41],[28,8,47,6],[29,8,48,6],[30,6,49,4],[32,6,51,4],[33,6,52,4],[33,10,52,10,"isPrevented"],[33,21,52,21],[33,24,52,24,"beforeRemoveListeners"],[33,45,52,45],[33,46,52,46,"route"],[33,51,52,51],[33,52,52,52,"key"],[33,55,52,55],[33,56,52,56],[33,59,52,59,"beforeRemoveAction"],[33,77,52,77],[33,78,52,78],[34,6,54,4],[34,10,54,8,"isPrevented"],[34,21,54,19],[34,23,54,21],[35,8,55,6],[35,15,55,13],[35,19,55,17],[36,6,56,4],[37,6,58,4,"visitedRouteKeys"],[37,22,58,20],[37,23,58,21,"add"],[37,26,58,24],[37,27,58,25,"route"],[37,32,58,30],[37,33,58,31,"key"],[37,36,58,34],[37,37,58,35],[38,6,60,4],[38,10,60,10,"event"],[38,15,60,15],[38,18,60,18,"emitter"],[38,25,60,25],[38,26,60,26,"emit"],[38,30,60,30],[38,31,60,31],[39,8,61,6,"type"],[39,12,61,10],[39,14,61,12],[39,28,61,26],[40,8,62,6,"target"],[40,14,62,12],[40,16,62,14,"route"],[40,21,62,19],[40,22,62,20,"key"],[40,25,62,23],[41,8,63,6,"data"],[41,12,63,10],[41,14,63,12],[42,10,63,14,"action"],[42,16,63,20],[42,18,63,22,"beforeRemoveAction"],[43,8,63,41],[43,9,63,42],[44,8,64,6,"canPreventDefault"],[44,25,64,23],[44,27,64,25],[45,6,65,4],[45,7,65,5],[45,8,65,6],[46,6,67,4],[46,10,67,8,"event"],[46,15,67,13],[46,16,67,14,"defaultPrevented"],[46,32,67,30],[46,34,67,32],[47,8,68,6],[47,15,68,13],[47,19,68,17],[48,6,69,4],[49,4,70,2],[50,4,72,2],[50,11,72,9],[50,16,72,14],[51,2,73,0],[51,3,73,1],[52,2,73,2,"exports"],[52,9,73,2],[52,10,73,2,"shouldPreventRemove"],[52,29,73,2],[52,32,73,2,"shouldPreventRemove"],[52,51,73,2],[53,2,75,15],[53,11,75,24,"useOnPreventRemove"],[53,29,75,42,"useOnPreventRemove"],[53,30,75,42,"_ref"],[53,34,75,42],[53,36,79,12],[54,4,79,12],[54,8,76,2,"getState"],[54,16,76,10],[54,19,76,10,"_ref"],[54,23,76,10],[54,24,76,2,"getState"],[54,32,76,10],[55,6,77,2,"emitter"],[55,13,77,9],[55,16,77,9,"_ref"],[55,20,77,9],[55,21,77,2,"emitter"],[55,28,77,9],[56,6,78,2,"beforeRemoveListeners"],[56,27,78,23],[56,30,78,23,"_ref"],[56,34,78,23],[56,35,78,2,"beforeRemoveListeners"],[56,56,78,23],[57,4,80,2],[57,8,80,2,"_React$useContext"],[57,25,80,2],[57,28,80,31,"React"],[57,33,80,36],[57,34,80,37,"useContext"],[57,44,80,47],[57,45,80,48,"NavigationBuilderContext"],[57,78,80,72],[57,79,80,73],[58,6,80,10,"addKeyedListener"],[58,22,80,26],[58,25,80,26,"_React$useContext"],[58,42,80,26],[58,43,80,10,"addKeyedListener"],[58,59,80,26],[59,4,81,2],[59,8,81,8,"route"],[59,13,81,13],[59,16,81,16,"React"],[59,21,81,21],[59,22,81,22,"useContext"],[59,32,81,32],[59,33,81,33,"NavigationRouteContext"],[59,64,81,55],[59,65,81,56],[60,4,82,2],[60,8,82,8,"routeKey"],[60,16,82,16],[60,19,82,19,"route"],[60,24,82,24],[60,26,82,26,"key"],[60,29,82,29],[61,4,84,2,"React"],[61,9,84,7],[61,10,84,8,"useEffect"],[61,19,84,17],[61,20,84,18],[61,26,84,24],[62,6,85,4],[62,10,85,8,"routeKey"],[62,18,85,16],[62,20,85,18],[63,8,86,6],[63,15,86,13,"addKeyedListener"],[63,31,86,29],[63,34,86,32],[63,48,86,46],[63,50,86,48,"routeKey"],[63,58,86,56],[63,60,86,59,"action"],[63,66,86,65],[63,70,86,70],[64,10,87,8],[64,14,87,14,"state"],[64,19,87,19],[64,22,87,22,"getState"],[64,30,87,30],[64,31,87,31],[64,32,87,32],[65,10,89,8],[65,17,89,15,"shouldPreventRemove"],[65,36,89,34],[65,37,90,10,"emitter"],[65,44,90,17],[65,46,91,10,"beforeRemoveListeners"],[65,67,91,31],[65,69,92,10,"state"],[65,74,92,15],[65,75,92,16,"routes"],[65,81,92,22],[65,83,93,10],[65,85,93,12],[65,87,94,10,"action"],[65,93,95,8],[65,94,95,9],[66,8,96,6],[66,9,96,7],[66,10,96,8],[67,6,97,4],[68,4,98,2],[68,5,98,3],[68,7,98,5],[68,8,98,6,"addKeyedListener"],[68,24,98,22],[68,26,98,24,"beforeRemoveListeners"],[68,47,98,45],[68,49,98,47,"emitter"],[68,56,98,54],[68,58,98,56,"getState"],[68,66,98,64],[68,68,98,66,"routeKey"],[68,76,98,74],[68,77,98,75],[68,78,98,76],[69,2,99,0],[70,0,99,1],[70,3]],"functionMap":{"names":["<global>","shouldPreventRemove","nextRoutes.map$argument_0","currentRoutes.filter$argument_0","useOnPreventRemove","React.useEffect$argument_0","addKeyedListener$argument_2"],"mappings":"AAA;mCCqB;uCCO,oBD;YEI,6CF;CDwC;eIE;kBCS;0DCE;ODU;GDE;CJC"}},"type":"js/module"}]}