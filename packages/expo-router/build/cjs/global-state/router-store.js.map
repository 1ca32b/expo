{"version":3,"file":"router-store.js","names":["_native","data","require","_expoConstants","_interopRequireDefault","SplashScreen","_interopRequireWildcard","_react","_Platform","_routing","_sortRoutes","_LocationProvider","_getPathFromState","_getLinkingConfig","_getRoutes","_useScreens","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","obj","RouterStore","hasAttemptedToHideSplash","rootStateSubscribers","Set","storeSubscribers","linkTo","bind","getSortedRoutes","goBack","canGoBack","push","dismiss","replace","dismissAll","canDismiss","setParams","navigate","initialize","context","navigationRef","linkingConfigOptions","initialState","undefined","rootState","nextState","linking","navigationRefSubscription","clear","routeNode","getRoutes","Constants","expoConfig","extra","router","ignoreEntryPoints","platform","Platform","OS","routeInfo","unstable_globalHref","pathname","isIndex","params","segments","getLinkingConfig","rootComponent","getQualifiedRouteComponent","initialURL","getInitialURL","getStateFromPath","config","getRouteInfo","process","env","NODE_ENV","Error","Fragment","addListener","state","splashScreenAnimationFrame","requestAnimationFrame","_internal_maybeHideAsync","shouldUpdateSubscribers","store","updateState","subscriber","nextRouteInfo","deepEqual","getRouteInfoFromState","asPath","getPathDataFromState","screens","preserveDynamicRoutes","preserveGroups","shouldShowTutorial","subscribeToRootState","add","delete","subscribeToStore","snapshot","rootStateSnapshot","routeInfoSnapshot","cleanup","cancelAnimationFrame","exports","useExpoRouter","useSyncExternalStore","syncStoreRootState","isReady","currentState","getRootState","useStoreRootState","useStoreRouteInfo","useInitializeExpoRouter","options","useNavigationContainerRef","useMemo"],"sources":["../../../src/global-state/router-store.tsx"],"sourcesContent":["import {\n  NavigationContainerRefWithCurrent,\n  getPathFromState,\n  useNavigationContainerRef,\n} from '@react-navigation/native';\nimport Constants from 'expo-constants';\nimport * as SplashScreen from 'expo-splash-screen';\nimport { useSyncExternalStore, useMemo, ComponentType, Fragment } from 'react';\nimport { Platform } from 'react-native';\n\nimport {\n  canGoBack,\n  canDismiss,\n  goBack,\n  linkTo,\n  navigate,\n  dismiss,\n  dismissAll,\n  push,\n  replace,\n  setParams,\n} from './routing';\nimport { getSortedRoutes } from './sort-routes';\nimport { UrlObject, getRouteInfoFromState } from '../LocationProvider';\nimport { RouteNode } from '../Route';\nimport { deepEqual, getPathDataFromState } from '../fork/getPathFromState';\nimport { ResultState } from '../fork/getStateFromPath';\nimport { ExpoLinkingOptions, LinkingConfigOptions, getLinkingConfig } from '../getLinkingConfig';\nimport { getRoutes } from '../getRoutes';\nimport { RequireContext } from '../types';\nimport { getQualifiedRouteComponent } from '../useScreens';\n\n/**\n * This is the global state for the router. It is used to keep track of the current route, and to provide a way to navigate to other routes.\n *\n * There should only be one instance of this class and be initialized via `useInitializeExpoRouter`\n */\nexport class RouterStore {\n  routeNode!: RouteNode | null;\n  rootComponent!: ComponentType;\n  linking?: ExpoLinkingOptions;\n  private hasAttemptedToHideSplash: boolean = false;\n\n  initialState?: ResultState;\n  rootState?: ResultState;\n  nextState?: ResultState;\n  routeInfo?: UrlObject;\n  splashScreenAnimationFrame?: number;\n\n  navigationRef!: NavigationContainerRefWithCurrent<ReactNavigation.RootParamList>;\n  navigationRefSubscription!: () => void;\n\n  rootStateSubscribers = new Set<() => void>();\n  storeSubscribers = new Set<() => void>();\n\n  linkTo = linkTo.bind(this);\n  getSortedRoutes = getSortedRoutes.bind(this);\n  goBack = goBack.bind(this);\n  canGoBack = canGoBack.bind(this);\n  push = push.bind(this);\n  dismiss = dismiss.bind(this);\n  replace = replace.bind(this);\n  dismissAll = dismissAll.bind(this);\n  canDismiss = canDismiss.bind(this);\n  setParams = setParams.bind(this);\n  navigate = navigate.bind(this);\n\n  initialize(\n    context: RequireContext,\n    navigationRef: NavigationContainerRefWithCurrent<ReactNavigation.RootParamList>,\n    linkingConfigOptions: LinkingConfigOptions = {}\n  ) {\n    // Clean up any previous state\n    this.initialState = undefined;\n    this.rootState = undefined;\n    this.nextState = undefined;\n    this.linking = undefined;\n    this.navigationRefSubscription?.();\n    this.rootStateSubscribers.clear();\n    this.storeSubscribers.clear();\n\n    this.routeNode = getRoutes(context, {\n      ...Constants.expoConfig?.extra?.router,\n      ignoreEntryPoints: true,\n      platform: Platform.OS,\n    });\n\n    // We always needs routeInfo, even if there are no routes. This can happen if:\n    //  - there are no routes (we are showing the onboarding screen)\n    //  - getInitialURL() is async\n    this.routeInfo = {\n      unstable_globalHref: '',\n      pathname: '',\n      isIndex: false,\n      params: {},\n      segments: [],\n    };\n\n    if (this.routeNode) {\n      // We have routes, so get the linking config and the root component\n      this.linking = getLinkingConfig(this.routeNode, context, linkingConfigOptions);\n      this.rootComponent = getQualifiedRouteComponent(this.routeNode);\n\n      // By default React Navigation is async and does not render anything in the first pass as it waits for `getInitialURL`\n      // This will cause static rendering to fail, which once performs a single pass.\n      // If the initialURL is a string, we can preload the state and routeInfo, skipping React Navigation's async behavior.\n      const initialURL = this.linking?.getInitialURL?.();\n      if (typeof initialURL === 'string') {\n        this.rootState = this.linking.getStateFromPath?.(initialURL, this.linking.config);\n        this.initialState = this.rootState;\n        if (this.rootState) {\n          this.routeInfo = this.getRouteInfo(this.rootState);\n        }\n      }\n    } else {\n      // Only error in production, in development we will show the onboarding screen\n      if (process.env.NODE_ENV === 'production') {\n        throw new Error('No routes found');\n      }\n\n      // In development, we will show the onboarding screen\n      this.rootComponent = Fragment;\n    }\n\n    /**\n     * Counter intuitively - this fires AFTER both React Navigation's state changes and the subsequent paint.\n     * This poses a couple of issues for Expo Router,\n     *   - Ensuring hooks (e.g. useSearchParams()) have data in the initial render\n     *   - Reacting to state changes after a navigation event\n     *\n     * This is why the initial render renders a Fragment and we wait until `onReady()` is called\n     * Additionally, some hooks compare the state from both the store and the navigationRef. If the store it stale,\n     * that hooks will manually update the store.\n     *\n     */\n    this.navigationRef = navigationRef;\n    this.navigationRefSubscription = navigationRef.addListener('state', (data) => {\n      const state = data.data.state as ResultState;\n\n      if (!this.hasAttemptedToHideSplash) {\n        this.hasAttemptedToHideSplash = true;\n        // NOTE(EvanBacon): `navigationRef.isReady` is sometimes not true when state is called initially.\n        this.splashScreenAnimationFrame = requestAnimationFrame(() => {\n          // @ts-expect-error: This function is native-only and for internal-use only.\n          SplashScreen._internal_maybeHideAsync?.();\n        });\n      }\n\n      let shouldUpdateSubscribers = this.nextState === state;\n      this.nextState = undefined;\n\n      // This can sometimes be undefined when an error is thrown in the Root Layout Route.\n      // Additionally that state may already equal the rootState if it was updated within a hook\n      if (state && state !== this.rootState) {\n        store.updateState(state, undefined);\n        shouldUpdateSubscribers = true;\n      }\n\n      // If the state has changed, or was changed inside a hook we need to update the subscribers\n      if (shouldUpdateSubscribers) {\n        for (const subscriber of this.rootStateSubscribers) {\n          subscriber();\n        }\n      }\n    });\n\n    for (const subscriber of this.storeSubscribers) {\n      subscriber();\n    }\n  }\n\n  updateState(state: ResultState, nextState = state) {\n    store.rootState = state;\n    store.nextState = nextState;\n\n    const nextRouteInfo = store.getRouteInfo(state);\n\n    if (!deepEqual(this.routeInfo, nextRouteInfo)) {\n      store.routeInfo = nextRouteInfo;\n    }\n  }\n\n  getRouteInfo(state: ResultState) {\n    return getRouteInfoFromState(\n      (state: Parameters<typeof getPathFromState>[0], asPath: boolean) => {\n        return getPathDataFromState(state, {\n          screens: {},\n          ...this.linking?.config,\n          preserveDynamicRoutes: asPath,\n          preserveGroups: asPath,\n        });\n      },\n      state\n    );\n  }\n\n  // This is only used in development, to show the onboarding screen\n  // In production we should have errored during the initialization\n  shouldShowTutorial() {\n    return !this.routeNode && process.env.NODE_ENV === 'development';\n  }\n\n  /** Make sure these are arrow functions so `this` is correctly bound */\n  subscribeToRootState = (subscriber: () => void) => {\n    this.rootStateSubscribers.add(subscriber);\n    return () => this.rootStateSubscribers.delete(subscriber);\n  };\n  subscribeToStore = (subscriber: () => void) => {\n    this.storeSubscribers.add(subscriber);\n    return () => this.storeSubscribers.delete(subscriber);\n  };\n  snapshot = () => {\n    return this;\n  };\n  rootStateSnapshot = () => {\n    return this.rootState!;\n  };\n  routeInfoSnapshot = () => {\n    return this.routeInfo!;\n  };\n\n  cleanup() {\n    if (this.splashScreenAnimationFrame) {\n      cancelAnimationFrame(this.splashScreenAnimationFrame);\n    }\n  }\n}\n\nexport const store = new RouterStore();\n\nexport function useExpoRouter() {\n  return useSyncExternalStore(store.subscribeToStore, store.snapshot, store.snapshot);\n}\n\nfunction syncStoreRootState() {\n  if (store.navigationRef.isReady()) {\n    const currentState = store.navigationRef.getRootState() as unknown as ResultState;\n\n    if (store.rootState !== currentState) {\n      store.updateState(currentState);\n    }\n  }\n}\n\nexport function useStoreRootState() {\n  syncStoreRootState();\n  return useSyncExternalStore(\n    store.subscribeToRootState,\n    store.rootStateSnapshot,\n    store.rootStateSnapshot\n  );\n}\n\nexport function useStoreRouteInfo() {\n  syncStoreRootState();\n  return useSyncExternalStore(\n    store.subscribeToRootState,\n    store.routeInfoSnapshot,\n    store.routeInfoSnapshot\n  );\n}\n\nexport function useInitializeExpoRouter(context: RequireContext, options: LinkingConfigOptions) {\n  const navigationRef = useNavigationContainerRef();\n  useMemo(() => store.initialize(context, navigationRef, options), [context]);\n  useExpoRouter();\n  return store;\n}\n"],"mappings":"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"}